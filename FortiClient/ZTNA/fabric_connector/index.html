
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://localhost:8000/FortiClient/ZTNA/fabric_connector/">
      
      
        <link rel="prev" href="../ztna_server_conn/">
      
      
        <link rel="next" href="../wad_diags/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.45">
    
    
      
        <title>Fabric Connector issues - VPdocs Support Training Program</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#connector-failure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
<p style="color:white">
    New FortiClient\EMS 7.4.1 has been released!
    Make sure to check out the <a href="https://docs.fortinet.com/document/forticlient/7.4.0/new-features/100268/7-4-1">release notes.</a>
    For overview of new FortiClient features see <a href="/FortiClient/New features/7.4.1">FortiClient 7.4.1 Features Overview</a> section.
    For EMS - <a href="/EMS/New features/7.4.1">EMS 7.4.1 Features Overview</a>.
</p>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="VPdocs Support Training Program" class="md-header__button md-logo" aria-label="VPdocs Support Training Program" data-md-component="logo">
      
  <img src="../../../assets/Fortinet-logo-rgb-white-red.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VPdocs Support Training Program
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fabric Connector issues
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  FortiClient

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../EMS/" class="md-tabs__link">
          
  
    
  
  EMS

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../FortiSASE/" class="md-tabs__link">
          
  
    
  
  FortiSASE

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../FortiDLP/" class="md-tabs__link">
          
  
    
  
  FortiDLP

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../practice/labs/" class="md-tabs__link">
          
  
    
  
  Practice

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Demos/forticlient_demos/" class="md-tabs__link">
          
  
    
  
  Demos

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="VPdocs Support Training Program" class="md-nav__button md-logo" aria-label="VPdocs Support Training Program" data-md-component="logo">
      
  <img src="../../../assets/Fortinet-logo-rgb-white-red.png" alt="logo">

    </a>
    VPdocs Support Training Program
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    FortiClient
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            FortiClient
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../New%20features/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    New features
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            New features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../New%20features/7.4.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../VPN/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    FortiClient VPN
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            FortiClient VPN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../VPN/init_conn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Initial Connection Issues
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../VPN/vpndrops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Addressing VPN Drops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../VPN/vpn_perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VPN Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../VPN/auto_connect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto-Connect and Always-up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../VPN/dns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS Issues
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Zero Trust Network Access
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Zero Trust Network Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ztna_certificate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZTNA Certificate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../posture_tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Posture Tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ztna_server_conn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZTNA connection issues
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Fabric Connector issues
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Fabric Connector issues
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#connector-failure" class="md-nav__link">
    <span class="md-ellipsis">
      Connector Failure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Connector Failure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-examine-the-error-code" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 – Examine the error code.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-equip-with-fos-cli-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 – Equip with FOS CLI tools.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-correlate-with-ems-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 – Correlate with EMS logs.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extras" class="md-nav__link">
    <span class="md-ellipsis">
      Extras
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tag-exchange-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Tag Exchange Issues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tag Exchange Issues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-understand-the-setup-and-network-topology" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1 – Understand the setup and network topology.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-collect-logs" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2 – Collect logs.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-analyze-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3 – Analyze the data.
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wad_diags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FortiGate WAD diagnostics analysis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../EMS/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    EMS
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            EMS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../EMS/New%20features/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    New features
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            New features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EMS/New%20features/7.4.1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7.4.1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    EMS on Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            EMS on Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../EMS/Linux/linux_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Navigating Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../FortiSASE/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    FortiSASE
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            FortiSASE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FortiSASE/SPA/spa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secure Private Access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../FortiSASE/VPN/ipsec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPsec VPN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../FortiDLP/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    FortiDLP
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FortiDLP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Practice
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Practice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../practice/labs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Labs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../practice/quizzes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quizzes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Demos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Demos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Demos/forticlient_demos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FortiClient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Demos/fortisase_demos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FortiSASE
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Fabric Connector issues</h1>

<p>Issues with Fabric Connector can vary and be categorized as following:</p>
<ul>
<li>Connector failure (can’t be established or goes up and down randomly)</li>
<li>Tag/endpoint information exchange issues (FortiGate missing tags)</li>
</ul>
<p>Let’s break them down and examine the strategies of addressing these issues.</p>
<h2 id="connector-failure">Connector Failure</h2>
<p><img alt="Fabric Connector failure image" src="../assets/fabric%20connector%20failure.png" /></p>
<p>Similar techniques can be employed for addressing connector failures or instabilities. The difference will be the timing due to sporadic nature of connector stability issues.</p>
<h3 id="step-1-examine-the-error-code">Step 1 – Examine the error code.</h3>
<p>Start with analyzing the error code presented by FortiGate’s EMS Fabric Connector. Even though most of the time connector issues will require diagnosing off of CLI, sometimes the error shown in the GUI can spill out some hints.</p>
<h3 id="step-2-equip-with-fos-cli-tools">Step 2 – Equip with FOS CLI tools.</h3>
<p>A good place to start is running Fabric Connector verification commands and examining the output. Here’s few commands you want to have under your belt:</p>
<div class="highlight"><pre><span></span><code>diagnose<span class="w"> </span>endpoint<span class="w"> </span>fctems<span class="w"> </span>test-connectivity<span class="w"> </span>&lt;EMS<span class="w"> </span>ID&gt;
execute<span class="w"> </span>fctems<span class="w"> </span>verify<span class="w"> </span>&lt;EMS<span class="w"> </span>ID&gt;<span class="w"> </span>
diagnose<span class="w"> </span><span class="nb">test</span><span class="w"> </span>application<span class="w"> </span>fcnacd<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p><img alt="fcnacd 1" src="../assets/fcnacd%201.png" /></p>
<p>The above are connection verification commands that don’t produce continuous output.</p>
<p>Next are the commands that show back-and-forth communication between FortiGate and EMS.</p>
<div class="highlight"><pre><span></span><code>diagnose<span class="w"> </span>debug<span class="w"> </span>application<span class="w"> </span>fcnacd<span class="w"> </span>-1
diagnose<span class="w"> </span>debug<span class="w"> </span>console<span class="w"> </span>timestamp<span class="w"> </span><span class="nb">enable</span>
diagnose<span class="w"> </span>endpoint<span class="w"> </span>filter<span class="w"> </span>show-large-data<span class="w"> </span>yes
diagnose<span class="w"> </span>debug<span class="w"> </span><span class="nb">enable</span>
</code></pre></div>
<p>The above commands return decoded data exchange between FortiGate and EMS. Most of the time, these CLI tools are sufficient for diagnosing the problem.</p>
<h3 id="step-3-correlate-with-ems-logs">Step 3 – Correlate with EMS logs.</h3>
<p>Depending on EMS version (7.2 or 7.4) you may need to analyze the following logs:</p>
<ul>
<li>Python logs (api, debug and error) – FortiGate–EMS Fabric communication is carried over API calls and Python logs store this information</li>
<li>fcmNotify (7.2) or notifyworker (7.4) – provide communication data like FortiGate registration attempts or periodic keep-alives (ping-pongs)</li>
</ul>
<h3 id="extras">Extras</h3>
<p>Here’s some other commands that one may find useful.</p>
<p><strong><code>diagnose endpoint fctems json gateway-mac-request</code></strong> - Outputs the JSON-formatted list of FortiGate’s interfaces (gateways) with IP- and MAC-addresses. This is the list FortiGate sends to EMS so the latter can identify which endpoints are directly connected to the firewall.</p>
<p><strong><code>diagnose test application fcnacd 5</code></strong> - Makes FortiGate to execute API calls to EMS’ API endpoints on demand.</p>
<p><strong><code>diagnose test application fcnacd 99</code></strong> - Restarts fcnacd daemon. Exercise caution when using this command. </p>
<p>Remember to use FortiGate commands for verification purposes. If analysis points to FortiGate having issues, make sure to engage dedicated FortiGate support engineer and communicate the results of your findings.</p>
<hr />
<div class="admonition danger">
<p class="admonition-title">Connector Stability Issies</p>
<p>Connector stability issues are harder to troubleshoot due to their sporadic nature. It may happen every few days, hours, or minutes, etc. Hence, one would either need to time them (in case there’s a pattern or failures happen every few minutes) or find a way to run diagnostics for a prolonged period of time. I’d recommend engaging FortiGate support for issues like this as they should have a knowledge of running CLI diagnostics for a prolonged period of time, collect crash dumps, etc.</p>
</div>
<h2 id="tag-exchange-issues">Tag Exchange Issues</h2>
<p>Another common issue is missing tags or endpoint information.</p>
<p>More often than not, these issues arise due to misunderstanding of how the technology works.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A common misconception is that having FortiClient connected to EMS and tagged is sufficient for the tags to appear on FortiGate <strong><em>which isn’t always correct.</em></strong></p>
</div>
<h3 id="step-1-understand-the-setup-and-network-topology">Step 1 – Understand the setup and network topology.</h3>
<p><img src="../assets/ZTNA over VPN.png" alt="ZTNA topology" width="400" height="400"></p>
<p><em>Are we talking about ZTNA or IP/MAC Access Control?</em></p>
<p><em>What is the topology - FortiClient connected via VPN to FortiGate, FortiClient is having FortiGate as default gateway, there’s L3 device in between FortiGate and FortiClient, etc.?</em></p>
<p><em>What are tagging rules a desired tag is comprised of?</em></p>
<hr />
<p>Having answers to questions like these will guide further troubleshooting efforts.</p>
<p>It goes without saying that an engineer must understand how different scenarios outlined above will affect tag sharing mechanics. </p>
<h3 id="step-2-collect-logs">Step 2 – Collect logs.</h3>
<p>Logs have to be collected from each component of ZT infrastructure – FortiClient, FortiGate, and EMS – though may vary depending on a given case <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>. </p>
<ol>
<li>FortiClient<ul>
<li>FortiClient diagnostics and logs (FortiESNAC or epctrl.log depending on OS) will tell whether machine has desired tag(s). This is the first place to start verifying tag mismatch issues.</li>
</ul>
</li>
<li>EMS diagnostics<ul>
<li>Since EMS can only have debug log enabled for 30 minutes, an engineer would have to align issue occurrence with EMS running in a debug mode.</li>
</ul>
</li>
<li>FortiGate<ul>
<li>Same goes with FortiGate – issue has to be reproduced while FortiGate CLI commands are executed.</li>
</ul>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Here’s few common cases when the issue is reproduceable or can be reproduced on demand:</p>
<ul>
<li>
<p>FortiClient connects to FortiGate VPN server which doesn’t reflect client’s IP-address matching a tag</p>
</li>
<li>
<p>FortiClient located behind FortiGate doesn’t have its tags synced causing policy violation</p>
</li>
<li>
<p>FortiClient attempts to reach ZTNA destination but FortiGate denies the request due to no policy matched</p>
</li>
</ul>
<p>Cases like these are easier to capture the diagnostic data for as they can be replicated when required.</p>
</div>
<h3 id="step-3-analyze-the-data">Step 3 – Analyze the data.</h3>
<p><strong>FortiClient</strong> is first to start with since it’s a subject for ZTNA evaluation and the instance that initiates the connection. Hence, make sure FortiClient has the tags required and is properly configured.</p>
<p><strong>FortiGate</strong> is where connection terminates. Check its logs and diagnostics and identify the cause for policy violation. FortiGate either has the information required for FortiClient’s posture evaluatuation or requests this information from EMS when the connection is made which makes EMS the next step in log analysis.</p>
<p><strong>EMS</strong> sends tagging rules to FortiClient and shares endpoint information (including tags) to FortiGate. EMS "reacts" to FortiGate requests so make sure to track them in earlier mentioned EMS logs. </p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>See Logs section under ZTNA <a href="../">landing page</a> for a complete list.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.indexes", "toc.follow", "toc.integrate", "search.suggest", "search.highlight", "search.share", "content.code.annotate", "content.footnote.tooltips", "header.autohide", "announce.dismiss"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>